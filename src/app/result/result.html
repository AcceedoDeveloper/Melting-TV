<div class="wrapper"  *ngIf="selectedResult as result">
  <!-- HEADER -->
  <div class="header">
    <div class="header-section">
      <div class="logo">
        <div class="logo-text">
          <!-- <div class="title">ACCEEDO</div>
          <div class="sub">MeltPro</div> -->
          <img style="height: 60px;" src="assets/logo.png" alt="Acceedo Logo" />
        </div>
      </div>
      <div class="header-line"></div>
    </div>
    

    <div class="header-section center">
      FURNACE-{{ result.spectrumResults[0]?.furnaceNo }}
    </div>

    <div class="header-section right">
      <div class="header-line"></div>
      Heat No :
      <b>{{ result.spectrumResults[0]?.heatNo }}</b>
    </div>
  </div>

  <!-- INFO CARD -->
  <div class="card">
    <div class="card-top">
      <div class="heat-no" >
        Result received at :
        <b>{{
          result.spectrumResults[0]?.createdAt
            | date : "MMM dd, yyyy hh:mm a"
        }}</b>
      </div>

      

      <div class="heat-no">
        Method :
        <b>{{ result.spectrumResults[0]?.Grade }}</b>
      </div>


      <div class="right" *ngIf="status" >
        <span class="tested-ok"> TESTED OK ‚úî</span>
      </div>

      <div class="right" *ngIf="!status" >
<span class="not-tested">Failed ‚úñ</span>
      </div>
    </div>

    <div class="divider"></div>
    <div class="info-grid">
      <div class="info-item">
        <label>Customer Name</label><br />
        <span>{{ result.customerName }}</span>
      </div>

      <div class="info-item">
        <label>Part Name</label><br />
        <span>{{ result.productName }}</span>
      </div>

      <div class="info-item">
        <label>Stage</label><br />
        <span>{{ result.spectrumResults[0]?.stage }}</span>
      </div>

      <div class="info-item">
        <label>Checked By</label><br />
        <span>{{ result.spectrumResults[0]?.testedBy }}</span>
      </div>

      <div class="info-item">
        <label>Grade</label><br />
        <span>{{ result.spectrumResults[0]?.Grade }}</span>
      </div>
    </div>
  </div>

  <div class="table-card">
    <div class="table-title">Spectro Lab Results</div>

    <table>
      <tbody>
        <ng-container
          *ngFor="
            let group of chunkArray(result.spectrumResults[0]?.result, 10);
            let i = index
          "
        >
          <!-- GAP BETWEEN SECTIONS -->
          <tr *ngIf="i > 0" class="gap-row">
            <td colspan="8"></td>
          </tr>

          <!-- ELEMENT HEADER -->
          <tr>
            <th>Element</th>
            <th *ngFor="let el of group">
              {{ el.isPlaceholder ? "-" : el.abbr }}
            </th>
          </tr>

          <!-- RESULT -->
          <tr>
  <td>Result %</td>
  <td
    *ngFor="let el of group"
    [ngClass]="!el.isPlaceholder ? getResultClass(el) : ''"
  >
    {{ el.isPlaceholder ? "-" : el.labResult }}
  </td>
</tr>


          <!-- REQUIRED -->
          <tr>
            <td>Required</td>
            <td *ngFor="let el of group">
              {{ el.isPlaceholder ? "-" : el.weightToBeAdded + " Kg" }}
            </td>
          </tr>

          <!-- ACTUAL -->
          <tr>
            <td>Actual Kg</td>
            <td *ngFor="let el of group" class="danger">
              <span *ngIf="el.qtyTaken !== undefined"  >{{ el.isPlaceholder ? "-" : el.qtyTaken + " Kg" }}</span>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>






<!-- <div class="tv-container"  *ngIf="!selectedResult" >

<div class="tv-container" *ngIf="rawData.length">

  <div class="header">
    <div class="logo">
                <img style="height: 60px;" src="assets/logo.png" alt="Acceedo Logo" />
    </div>
    <div class="header-title">SPECTRUM LAB RESULTS</div>
  </div>

  <div class="card" *ngFor="let furnace of rawData; let i = index">
    <div class="card-title">Furnace {{ i === 0 ? 'A' : 'B' }}</div>

    <div class="stage-row">
      <div class="stage-label">Stage</div>

      <div class="timeline-container">
  <div class="stage-label-col">Stage</div>

  <ul class="timeline">
    <li
      class="timeline-item"
      *ngFor="let stage of furnace.stages; let i = index; let last = last"
      [class.active]="last"
      [class.line-green]="last"
      [class.icon-green]="last"
    >
      <div class="icon-wrapper">
        <img
          [src]="getStageIcon(stage.status)"
          alt="stage icon"
        />
      </div>

      <div class="item-content">
        <span class="title">{{ stage.name }}</span>
        <span class="date">
          {{ stage.createdAt | date:'dd/MM/yy HH:mm' }}
        </span>
      </div>
    </li>
  </ul>
</div>

    </div>
  </div>

</div>

</div> -->




<div *ngIf="!selectedResult && rawData.length > 0" >


  <div class="dashboard-container">
        <div class="header2">
    <div class="logo">
                <img style="height: 60px;" src="assets/logo.png" alt="Acceedo Logo" />
    </div>
    <div class="header-title">Furnace Stage</div>
  </div>

        <div class="furnace-card" *ngFor="let furnace of rawData; let fIndex = index">

  <div class="furnace-header">
    Furnace {{ fIndex === 0 ? 'A' : 'B' }}
  </div>

  <div class="workflow-container">
    <div class="stage-label">Stage</div>

   <div class="timeline">

  <ng-container
    *ngFor="let stage of ALL_STAGES; let i = index">

    <!-- STEP -->
    <div class="step">
      <div class="icon-circle"
           [class.active]="isCurrent(stage.status, getCurrentStageIndex(furnace))"
           [class.finished]="isFinished(stage.status, getCurrentStageIndex(furnace))"
           [class.gray]="isUpcoming(stage.status, getCurrentStageIndex(furnace))">
        {{ getStageEmoji(stage.status) }}
      </div>

      <div class="step-info">
        <span class="step-name">{{ stage.name }}</span>

        <span class="step-date"
              *ngIf="getStageDate(furnace, stage.status)">
          {{ getStageDate(furnace, stage.status) | date:'dd/MM/yy HH:mm' }}
        </span>
      </div>
    </div>

    <!-- CONNECTOR -->
    <div *ngIf="i < ALL_STAGES.length - 1"
         class="connector"
         [class.active]="stage.status < getCurrentStageIndex(furnace)"
         [class.gray]="stage.status >= getCurrentStageIndex(furnace)">
      <span class="conn-emoji"
            [class.active]="stage.status < getCurrentStageIndex(furnace)">
        üèÉ
      </span>
    </div>

  </ng-container>

</div>

  </div>
</div>

          

   
    </div>



</div>





<div  *ngIf="rawData.length === 0" >

     <div class="dashboard-container2">
        <header class="main-header">
            <h1>Spectro Lab Furnace Results</h1>
            <p class="subtitle">Client: ABC</p>
            <p class="subtitle">Product: Steel 123</p>
        </header>

        <div class="charts-grid">
            <div class="card2 theme-cyan">
                <div class="card-header">
                    <span class="element-symbol">Mo</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>

                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,120 150,95 190,105 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="120" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="105" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-yellow">
                <div class="card-header">
                    <span class="element-symbol">P</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,115 150,95 190,100 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="115" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="100" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-red">
                <div class="card-header">
                    <span class="element-symbol">Sn</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">600</text>
                        </g>
                        <polyline points="80,125 150,95 190,105 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="105" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-cyan">
                <div class="card-header">
                    <span class="element-symbol">Cr</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,125 150,95 190,105 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="105" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-yellow">
                <div class="card-header">
                    <span class="element-symbol">Si</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,125 150,95 190,100 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="100" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-red">
                <div class="card-header">
                    <span class="element-symbol">Cr</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">600</text>
                        </g>
                        <polyline points="80,125 150,95 190,105 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="105" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-cyan">
                <div class="card-header">
                    <span class="element-symbol">Cr</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,125 150,95 190,105 220,80 290,65" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="105" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="65" r="4" class="data-point" />
                    </svg>
                </div>
            </div>

            <div class="card2 theme-yellow">
                <div class="card-header">
                    <span class="element-symbol">Mn</span>
                    <span class="element-value">5%</span>
                </div>
                <div class="chart-container">
                    <svg viewBox="0 0 320 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="grid">
                            <line x1="30" y1="130" x2="310" y2="130" class="grid-line" />
                            <line x1="30" y1="70" x2="310" y2="70" class="grid-line" />
                            <line x1="30" y1="45" x2="310" y2="45" class="grid-line" />
                            <text x="25" y="135" class="y-label">0</text>
                            <text x="25" y="75" class="y-label">5%</text>
                            <text x="25" y="50" class="y-label">7%</text>
                            <text x="80" y="155" class="x-label">100</text>
                            <text x="150" y="155" class="x-label">200</text>
                            <text x="220" y="155" class="x-label">300</text>
                            <text x="290" y="155" class="x-label">400</text>
                        </g>
                        <polyline points="80,125 150,95 190,100 220,80 290,70" class="data-line" />
                        <circle cx="80" cy="125" r="4" class="data-point" />
                        <circle cx="150" cy="95" r="4" class="data-point" />
                        <circle cx="190" cy="100" r="4" class="data-point" />
                        <circle cx="220" cy="80" r="4" class="data-point" />
                        <circle cx="290" cy="70" r="4" class="data-point" />
                    </svg>
                </div>
            </div>
        </div>
    </div>








</div>